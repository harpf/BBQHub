@page
@model BBQHub.Pages.Admin.LogsModel
@{
    ViewData["Title"] = "System-Logs";
}

<h1 class="text-2xl font-bold text-orange-500 mb-6">📝 System-Logs</h1>

<!-- Erfolg oder Fehlermeldung -->
@if (TempData["Message"] != null)
{
    <div class="alert bg-orange-500 text-white p-4 rounded">
        @TempData["Message"]
    </div>
}

<!-- Formular für die Logs-Suche -->
<form method="get" class="bg-zinc-800 p-4 rounded mb-6 flex flex-wrap gap-4 text-white">
    <input type="text" name="SearchTerm" value="@Model.SearchTerm" placeholder="🔍 Suche..." class="p-2 rounded border bg-zinc-900 text-white"
           list="searchSuggestionsList" />

    <!-- Vorschläge für die Suche -->
    <datalist id="searchSuggestionsList">
        @foreach (var keyword in Model.CustomKeywords)
        {
            <option value="@keyword"></option>
        }
    </datalist>

    <select name="SelectedLevel" class="p-2 rounded border bg-zinc-900 text-white">
        <option value="">Alle Level</option>
        @foreach (var level in Model.AvailableLevels)
        {
            <option value="@level" selected="@(Model.SelectedLevel == level)">
                @level
            </option>
        }
    </select>

    <input type="date" name="StartDate" value="@Model.StartDate?.ToString("yyyy-MM-dd")" class="p-2 rounded border bg-zinc-900 text-white" />
    <input type="date" name="EndDate" value="@Model.EndDate?.ToString("yyyy-MM-dd")" class="p-2 rounded border bg-zinc-900 text-white" />

    <button type="submit" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded">
        Filter anwenden
    </button>
</form>

<!-- Tabelle für Logs -->
<table class="min-w-full text-sm text-left bg-zinc-800 text-white shadow-lg rounded">
    <thead class="bg-zinc-700 text-xs uppercase tracking-wide">
        <tr>
            <th class="p-2">Zeitpunkt</th>
            <th class="p-2">Level</th>
            <th class="p-2">Nachricht</th>
            <th class="p-2">Exception</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var log in Model.Logs)
        {
            <tr class="border-b border-zinc-700 hover:bg-zinc-900">
                <td class="p-2">@log.TimeStamp.ToString("g")</td>
                <td class="p-2">@log.Level</td>
                <td class="p-2">@log.Message</td>
                <td class="p-2 text-red-400">@log.Exception</td>
            </tr>
        }
    </tbody>
</table>

<!-- Paginierung -->
<div class="mt-4 flex justify-center gap-4">
    @for (int i = 1; i <= Math.Ceiling((double)Model.Logs.Count / 20); i++)
    {
        <a href="@Model.SetPageUrl(i)" class="px-4 py-2 bg-zinc-800 text-white rounded hover:bg-zinc-700">@i</a>
    }
</div>