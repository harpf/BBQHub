@page
@model BBQHub.Pages.Admin.LogsModel
@{
    ViewData["Title"] = "System-Logs";
}

<div class="flex justify-center items-center min-h-screen bg-zinc-900 px-4">

    <div class="bg-zinc-800 p-8 rounded-2xl shadow-lg w-full max-w-4xl border border-zinc-700">

        <h1 class="text-3xl font-bold text-orange-500 mb-6 text-center drop-shadow">📝 System-Logs</h1>

        <!-- Erfolg oder Fehlermeldung -->
        @if (TempData["Message"] != null)
        {
            <div class="alert bg-orange-500 text-white p-4 rounded mb-4">
                @TempData["Message"]
            </div>
        }

        <!-- Formular für die Logs-Suche -->
        <form method="get" class="bg-zinc-800 p-6 rounded-lg mb-6 flex flex-wrap gap-6 text-white">
            <div class="w-full sm:w-1/3">
                <label for="SearchTerm" class="block text-sm font-semibold mb-2">Suche</label>
                <input type="text" name="SearchTerm" value="@Model.SearchTerm" placeholder="🔍 Suche..." class="w-full p-3 rounded-lg bg-zinc-700 border border-zinc-600 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500 shadow-sm"
                       list="searchSuggestionsList" />
            </div>

            <!-- Vorschläge für die Suche -->
            <datalist id="searchSuggestionsList">
                @foreach (var keyword in Model.CustomKeywords)
                {
                    <option value="@keyword"></option>
                }
            </datalist>

            <div class="w-full sm:w-1/3">
                <label for="SelectedLevel" class="block text-sm font-semibold mb-2">Level</label>
                <select name="SelectedLevel" class="w-full p-3 rounded-lg bg-zinc-700 border border-zinc-600 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500 shadow-sm">
                    <option value="">Alle Level</option>
                    @foreach (var level in Model.AvailableLevels)
                    {
                        <option value="@level" selected="@(Model.SelectedLevel == level)">
                            @level
                        </option>
                    }
                </select>
            </div>

            <div class="w-full sm:w-1/3">
                <label for="StartDate" class="block text-sm font-semibold mb-2">Startdatum</label>
                <input type="date" name="StartDate" value="@Model.StartDate?.ToString("yyyy-MM-dd")" class="w-full p-3 rounded-lg bg-zinc-700 border border-zinc-600 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500 shadow-sm" />
            </div>

            <div class="w-full sm:w-1/3">
                <label for="EndDate" class="block text-sm font-semibold mb-2">Enddatum</label>
                <input type="date" name="EndDate" value="@Model.EndDate?.ToString("yyyy-MM-dd")" class="w-full p-3 rounded-lg bg-zinc-700 border border-zinc-600 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500 shadow-sm" />
            </div>

            <div class="w-full mt-6">
                <button type="submit" class="w-full sm:w-auto bg-orange-600 text-white px-6 py-3 rounded-lg hover:bg-orange-700 transition duration-200 shadow-md font-semibold">
                    Filter anwenden
                </button>
            </div>
        </form>

        <!-- Tabelle für Logs -->
        <div class="overflow-x-auto">
            <table class="min-w-full text-sm text-left bg-zinc-800 text-white shadow-lg rounded-lg">
                <thead class="bg-zinc-700 text-xs uppercase tracking-wide">
                    <tr>
                        <th class="p-4">Zeitpunkt</th>
                        <th class="p-4">Level</th>
                        <th class="p-4">Nachricht</th>
                        <th class="p-4">Exception</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var log in Model.Logs)
                    {
                        <tr class="border-b border-zinc-700 hover:bg-zinc-900">
                            <td class="p-4">@log.TimeStamp.ToString("g")</td>
                            <td class="p-4">@log.Level</td>
                            <td class="p-4">@log.Message</td>
                            <td class="p-4 text-red-400">@log.Exception</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <!-- Paginierung -->
        <div class="mt-6 flex justify-center gap-4">
            @for (int i = 1; i <= Math.Ceiling((double)Model.Logs.Count / 20); i++)
            {
                <a href="@Model.SetPageUrl(i)" class="px-6 py-3 bg-zinc-700 text-white rounded-lg hover:bg-zinc-600 transition duration-150 font-semibold">
                    @i
                </a>
            }
        </div>

    </div>
</div>